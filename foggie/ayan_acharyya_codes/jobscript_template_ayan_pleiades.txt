#!/bin/bash

#This template is adapted from Molly's foggie/examples/RunScript.sh; see there for explanations

#PBS -N RUN_NAME

##### Resources #####
#PBS -W group_list=PROJ_CODE
#PBS -l select=NNODES:ncpus=NCORES:mpiprocs=NCORES:model=PROC
#PBS -l walltime=NHOURS:00:00

##### Queue #####
#PBS -q QNAME

##### Mail Options #####
#PBS -m abe
#PBS -M aachary9@jhu.edu

##this is commented out ## #set output and error directories
##this is commented out ## #PBS -j oe
##this is commented out ## #PBS -o output_RUN_NAME.out

##### Change to current working directory #####
cd WORKDIR

##### Execute Program #####
top -b -u $USER -n 172800 1>top_RUN_NAME.out &
#mpirun -n NCPUS python CALLFILE SYSTEMFLAG DRYRUNFLAG HALOFLAG MERGEHIIFLAG DO_ALL_SIMSFLAG DO_ALL_HALOSFLAG
mpirun -n NCPUS python CALLFILE SYSTEMFLAG DRYRUNFLAG HALOFLAG MERGEHIIFLAG DO_ALL_SIMSFLAG DO_ALL_HALOSFLAG 1>output_RUN_NAME.out 2>&1
killall 'top'
